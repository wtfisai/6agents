# DesignSync AI - Implementation Guide
## AI-Generated Design Systems with Bidirectional Sync

### Project Overview
**Product Name**: DesignSync AI  
**Repository**: `https://github.com/wtfisai/designsync-ai.git`  
**Primary Function**: AI-powered design system generator with real-time bidirectional sync between Figma and code  
**Target Market**: Growth-stage SaaS companies (Series A-B) with 20-100 employees  
**Revenue Model**: SaaS subscription ($99-$1,999/month)  
**Tech Stack**: Node.js, TypeScript, React, Firebase, Gemini AI, Figma API

---

## 1. Folder Architecture Overview

```
designsync-ai/
├── .github/
│   ├── workflows/
│   │   ├── ci.yml                 # Continuous Integration
│   │   ├── cd-dev.yml             # Deploy to dev environment
│   │   ├── cd-prod.yml            # Deploy to production
│   │   └── security-scan.yml      # Security scanning
│   └── CODEOWNERS
├── apps/
│   ├── web/                       # Main web application
│   │   ├── src/
│   │   │   ├── components/        # React components
│   │   │   ├── features/          # Feature modules
│   │   │   │   ├── auth/
│   │   │   │   ├── dashboard/
│   │   │   │   ├── design-system/
│   │   │   │   └── sync-engine/
│   │   │   ├── hooks/             # Custom React hooks
│   │   │   ├── lib/               # Utility libraries
│   │   │   ├── pages/             # Next.js pages
│   │   │   └── styles/            # CSS/Tailwind styles
│   │   ├── public/
│   │   ├── package.json
│   │   └── next.config.js
│   ├── figma-plugin/              # Figma plugin code
│   │   ├── src/
│   │   │   ├── ui/                # Plugin UI (React)
│   │   │   ├── plugin/            # Plugin logic
│   │   │   └── shared/            # Shared types/utils
│   │   ├── manifest.json
│   │   └── package.json
│   └── api/                       # Backend API
│       ├── src/
│       │   ├── controllers/       # Request handlers
│       │   ├── services/          # Business logic
│       │   │   ├── ai/            # AI/ML services
│       │   │   ├── sync/          # Sync engine
│       │   │   └── figma/         # Figma integration
│       │   ├── models/            # Data models
│       │   ├── middleware/        # Express middleware
│       │   └── utils/             # Utilities
│       ├── package.json
│       └── tsconfig.json
├── packages/                      # Shared packages
│   ├── design-tokens/             # Design token library
│   │   ├── src/
│   │   └── package.json
│   ├── sync-protocol/            # CRDT sync protocol
│   │   ├── src/
│   │   └── package.json
│   └── ui-components/            # Shared UI components
│       ├── src/
│       └── package.json
├── infrastructure/
│   ├── firebase/
│   │   ├── firestore.rules       # Firestore security rules
│   │   ├── firestore.indexes.json
│   │   └── storage.rules
│   ├── terraform/                # Infrastructure as code
│   └── docker/                   # Docker configurations
├── scripts/
│   ├── setup.sh                  # Main setup script
│   ├── deploy.sh                 # Deployment script
│   ├── seed-data.js             # Database seeding
│   └── generate-tokens.js       # Token generation
├── tests/
│   ├── unit/
│   ├── integration/
│   └── e2e/
├── docs/
│   ├── API.md
│   ├── ARCHITECTURE.md
│   ├── DEPLOYMENT.md
│   └── CONTRIBUTING.md
├── .env.example                  # Environment variables template
├── .gitignore
├── firebase.json                 # Firebase configuration
├── package.json                  # Root package.json
├── turbo.json                   # Turborepo configuration
├── README.md                    # Strategic documentation
└── LICENSE
```

---

## 2. Environment Variables Configuration

Create `.env.example` file with the following variables:

```bash
# Firebase Configuration
FIREBASE_API_KEY=prompt_for_input
FIREBASE_AUTH_DOMAIN=prompt_for_input
FIREBASE_PROJECT_ID=prompt_for_input
FIREBASE_STORAGE_BUCKET=prompt_for_input
FIREBASE_MESSAGING_SENDER_ID=prompt_for_input
FIREBASE_APP_ID=prompt_for_input
FIREBASE_MEASUREMENT_ID=prompt_for_input

# Google AI Configuration
GOOGLE_AI_API_KEY=prompt_for_input
VERTEX_AI_PROJECT=prompt_for_input
GEMINI_API_KEY=prompt_for_input

# Figma Integration
FIGMA_CLIENT_ID=prompt_for_input
FIGMA_CLIENT_SECRET=prompt_for_input
FIGMA_WEBHOOK_SECRET=prompt_for_input
FIGMA_PERSONAL_ACCESS_TOKEN=prompt_for_input

# Stripe Payment Processing
STRIPE_SECRET_KEY=prompt_for_input
STRIPE_PUBLISHABLE_KEY=prompt_for_input
STRIPE_WEBHOOK_SECRET=prompt_for_input

# Database URLs
DATABASE_URL=prompt_for_input
REDIS_URL=prompt_for_input

# Authentication
JWT_SECRET=prompt_for_input
SESSION_SECRET=prompt_for_input
OAUTH_REDIRECT_URI=http://localhost:3000/auth/callback

# Email Service (SendGrid)
SENDGRID_API_KEY=prompt_for_input
FROM_EMAIL=noreply@designsync.ai

# Monitoring
SENTRY_DSN=prompt_for_input
GOOGLE_ANALYTICS_ID=prompt_for_input
MIXPANEL_TOKEN=prompt_for_input

# Feature Flags
ENABLE_AI_GENERATION=true
ENABLE_SYNC_ENGINE=true
ENABLE_PREMIUM_FEATURES=false
RATE_LIMIT_REQUESTS=1000
RATE_LIMIT_WINDOW=3600000

# Environment
NODE_ENV=development
PORT=3000
API_PORT=3001
```

---

## 3. Dependencies and Third-Party Integrations

### Core Dependencies

```json
{
  "dependencies": {
      "@google/generative-ai": "^0.5.0",
          "@figma/plugin-typings": "^1.82.0",
              "@firebase/app": "^0.10.0",
                  "@firebase/auth": "^1.7.0",
                      "@firebase/firestore": "^4.6.0",
                          "@firebase/functions": "^0.11.0",
                              "@firebase/storage": "^0.12.0",
                                  "stripe": "^14.0.0",
                                      "next": "^14.1.0",
                                          "react": "^18.2.0",
                                              "typescript": "^5.3.0",
                                                  "express": "^4.18.0",
                                                      "socket.io": "^4.7.0",
                                                          "yjs": "^13.6.0",
                                                              "zod": "^3.22.0",
                                                                  "tailwindcss": "^3.4.0",
                                                                      "@radix-ui/react-dialog": "^1.0.0",
                                                                          "@tanstack/react-query": "^5.0.0"
                                                                            },
                                                                              "devDependencies": {
                                                                                  "@types/node": "^20.0.0",
                                                                                      "turbo": "^1.11.0",
                                                                                          "vitest": "^1.0.0",
                                                                                              "playwright": "^1.40.0",
                                                                                                  "eslint": "^8.56.0",
                                                                                                      "prettier": "^3.2.0"
                                                                                                        }
                                                                                                        }
                                                                                                        ```

                                                                                                        ### Optional Future Integrations
                                                                                                        - **Analytics**: Amplitude, Heap
                                                                                                        - **Customer Support**: Intercom, Crisp
                                                                                                        - **Error Tracking**: Rollbar, Bugsnag
                                                                                                        - **A/B Testing**: Optimizely, LaunchDarkly
                                                                                                        - **CDN**: Cloudflare, Fastly
                                                                                                        - **Search**: Algolia, Typesense

                                                                                                        ---

                                                                                                        ## 4. Setup Script (setup.sh)

                                                                                                        ```bash
                                                                                                        #!/bin/bash

                                                                                                        # DesignSync AI - Automated Setup Script
                                                                                                        # This script configures the entire development environment

                                                                                                        set -e  # Exit on error

                                                                                                        # Color codes for output
                                                                                                        RED='\033[0;31m'
                                                                                                        GREEN='\033[0;32m'
                                                                                                        YELLOW='\033[1;33m'
                                                                                                        NC='\033[0m' # No Color

                                                                                                        # ASCII Art Banner
                                                                                                        echo -e "${GREEN}"
                                                                                                        cat << "EOF"
                                                                                                        ╔══════════════════════════════════════════════════╗
                                                                                                        ║         DesignSync AI - Setup Wizard             ║
                                                                                                        ║     AI-Powered Design System Generator           ║
                                                                                                        ╚══════════════════════════════════════════════════╝
                                                                                                        EOF
                                                                                                        echo -e "${NC}"

                                                                                                        # Function to prompt for input
                                                                                                        prompt_input() {
                                                                                                            local var_name=$1
                                                                                                                local prompt_text=$2
                                                                                                                    local is_secret=$3
                                                                                                                        
                                                                                                                            if [ "$is_secret" = "true" ]; then
                                                                                                                                    read -sp "→ $prompt_text: " value
                                                                                                                                            echo
                                                                                                                                                else
                                                                                                                                                        read -p "→ $prompt_text: " value
                                                                                                                                                            fi
                                                                                                                                                                
                                                                                                                                                                    if [ -z "$value" ]; then
                                                                                                                                                                            echo -e "${RED}Error: $var_name cannot be empty${NC}"
                                                                                                                                                                                    exit 1
                                                                                                                                                                                        fi
                                                                                                                                                                                            
                                                                                                                                                                                                echo "$var_name=$value" >> .env
                                                                                                                                                                                                }

                                                                                                                                                                                                # Step 1: Check prerequisites
                                                                                                                                                                                                echo -e "${YELLOW}Step 1: Checking prerequisites...${NC}"
                                                                                                                                                                                                command -v node >/dev/null 2>&1 || { echo -e "${RED}Node.js is required but not installed.${NC}" >&2; exit 1; }
                                                                                                                                                                                                command -v npm >/dev/null 2>&1 || { echo -e "${RED}npm is required but not installed.${NC}" >&2; exit 1; }
                                                                                                                                                                                                command -v git >/dev/null 2>&1 || { echo -e "${RED}Git is required but not installed.${NC}" >&2; exit 1; }

                                                                                                                                                                                                NODE_VERSION=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)
                                                                                                                                                                                                if [ "$NODE_VERSION" -lt 18 ]; then
                                                                                                                                                                                                    echo -e "${RED}Node.js version 18+ is required${NC}"
                                                                                                                                                                                                        exit 1
                                                                                                                                                                                                        fi

                                                                                                                                                                                                        echo -e "${GREEN}✓ All prerequisites met${NC}"

                                                                                                                                                                                                        # Step 2: Clone repository
                                                                                                                                                                                                        echo -e "${YELLOW}Step 2: Setting up repository...${NC}"
                                                                                                                                                                                                        REPO_URL="https://github.com/wtfisai/designsync-ai.git"
                                                                                                                                                                                                        GITHUB_TOKEN="${GITHUB_TOKEN:-}"

                                                                                                                                                                                                        # Configure git with token
                                                                                                                                                                                                        git config --global url."https://${GITHUB_TOKEN}@github.com/".insteadOf "https://github.com/"

                                                                                                                                                                                                        # Clone or create repository
                                                                                                                                                                                                        if [ ! -d ".git" ]; then
                                                                                                                                                                                                            git init
                                                                                                                                                                                                                git remote add origin $REPO_URL
                                                                                                                                                                                                                    git branch -M main
                                                                                                                                                                                                                        
                                                                                                                                                                                                                            # Create initial commit
                                                                                                                                                                                                                                echo "# DesignSync AI" > README_temp.md
                                                                                                                                                                                                                                    git add README_temp.md
                                                                                                                                                                                                                                        git commit -m "Initial commit"
                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                # Try to push, create repo if it doesn't exist
                                                                                                                                                                                                                                                    if ! git push -u origin main 2>/dev/null; then
                                                                                                                                                                                                                                                            echo -e "${YELLOW}Creating repository...${NC}"
                                                                                                                                                                                                                                                                    curl -H "Authorization: token $GITHUB_TOKEN" \
                                                                                                                                                                                                                                                                                 -H "Accept: application/vnd.github.v3+json" \
                                                                                                                                                                                                                                                                                              https://api.github.com/user/repos \
                                                                                                                                                                                                                                                                                                           -d '{"name":"designsync-ai","private":false,"description":"AI-powered design system generator with bidirectional sync"}'
                                                                                                                                                                                                                                                                                                                   sleep 2
                                                                                                                                                                                                                                                                                                                           git push -u origin main
                                                                                                                                                                                                                                                                                                                               fi
                                                                                                                                                                                                                                                                                                                                   rm README_temp.md
                                                                                                                                                                                                                                                                                                                                   fi

                                                                                                                                                                                                                                                                                                                                   # Step 3: Create branch structure
                                                                                                                                                                                                                                                                                                                                   echo -e "${YELLOW}Step 3: Setting up branch structure...${NC}"
                                                                                                                                                                                                                                                                                                                                   git checkout -b dev 2>/dev/null || git checkout dev
                                                                                                                                                                                                                                                                                                                                   git checkout -b prod 2>/dev/null || git checkout prod
                                                                                                                                                                                                                                                                                                                                   git checkout main

                                                                                                                                                                                                                                                                                                                                   # Protect main branch
                                                                                                                                                                                                                                                                                                                                   curl -X PUT \
                                                                                                                                                                                                                                                                                                                                        -H "Authorization: token $GITHUB_TOKEN" \
                                                                                                                                                                                                                                                                                                                                             -H "Accept: application/vnd.github.v3+json" \
                                                                                                                                                                                                                                                                                                                                                  https://api.github.com/repos/wtfisai/designsync-ai/branches/main/protection \
                                                                                                                                                                                                                                                                                                                                                       -d '{
                                                                                                                                                                                                                                                                                                                                                              "required_status_checks": {
                                                                                                                                                                                                                                                                                                                                                                       "strict": true,
                                                                                                                                                                                                                                                                                                                                                                                "contexts": ["continuous-integration"]
                                                                                                                                                                                                                                                                                                                                                                                       },
                                                                                                                                                                                                                                                                                                                                                                                              "enforce_admins": false,
                                                                                                                                                                                                                                                                                                                                                                                                     "required_pull_request_reviews": {
                                                                                                                                                                                                                                                                                                                                                                                                              "required_approving_review_count": 1
                                                                                                                                                                                                                                                                                                                                                                                                                     },
                                                                                                                                                                                                                                                                                                                                                                                                                            "restrictions": null
                                                                                                                                                                                                                                                                                                                                                                                                                                 }' 2>/dev/null || echo "Branch protection already configured"

                                                                                                                                                                                                                                                                                                                                                                                                                                 # Step 4: Environment Configuration
                                                                                                                                                                                                                                                                                                                                                                                                                                 echo -e "${YELLOW}Step 4: Configuring environment variables...${NC}"

                                                                                                                                                                                                                                                                                                                                                                                                                                 if [ -f .env ]; then
                                                                                                                                                                                                                                                                                                                                                                                                                                     echo -e "${YELLOW}Existing .env file found. Backing up to .env.backup${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         mv .env .env.backup
                                                                                                                                                                                                                                                                                                                                                                                                                                         fi

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Create new .env file
                                                                                                                                                                                                                                                                                                                                                                                                                                         touch .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "# DesignSync AI Environment Configuration" > .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "# Generated on $(date)" >> .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "" >> .env

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Collect Firebase credentials
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${GREEN}Firebase Configuration${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_API_KEY" "Firebase API Key" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_AUTH_DOMAIN" "Firebase Auth Domain" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_PROJECT_ID" "Firebase Project ID" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_STORAGE_BUCKET" "Firebase Storage Bucket" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_MESSAGING_SENDER_ID" "Firebase Messaging Sender ID" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIREBASE_APP_ID" "Firebase App ID" false

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Collect AI credentials
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${GREEN}AI/ML Configuration${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "GOOGLE_AI_API_KEY" "Google AI API Key" true
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "GEMINI_API_KEY" "Gemini API Key" true

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Collect Figma credentials
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${GREEN}Figma Integration${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIGMA_CLIENT_ID" "Figma Client ID" false
                                                                                                                                                                                                                                                                                                                                                                                                                                         prompt_input "FIGMA_CLIENT_SECRET" "Figma Client Secret" true

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Generate secrets
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${GREEN}Generating secure secrets...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         JWT_SECRET=$(openssl rand -hex 32)
                                                                                                                                                                                                                                                                                                                                                                                                                                         SESSION_SECRET=$(openssl rand -hex 32)
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "JWT_SECRET=$JWT_SECRET" >> .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "SESSION_SECRET=$SESSION_SECRET" >> .env

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Set defaults
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "NODE_ENV=development" >> .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "PORT=3000" >> .env
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo "API_PORT=3001" >> .env

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 5: Install dependencies
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 5: Installing dependencies...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         npm install -g pnpm turbo firebase-tools
                                                                                                                                                                                                                                                                                                                                                                                                                                         pnpm install

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 6: Initialize Firebase
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 6: Initializing Firebase...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         firebase login --no-localhost
                                                                                                                                                                                                                                                                                                                                                                                                                                         firebase init --project ${FIREBASE_PROJECT_ID:-designsync-ai}

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 7: Create folder structure
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 7: Creating project structure...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                         mkdir -p apps/{web,figma-plugin,api}/src
                                                                                                                                                                                                                                                                                                                                                                                                                                         mkdir -p packages/{design-tokens,sync-protocol,ui-components}/src
                                                                                                                                                                                                                                                                                                                                                                                                                                         mkdir -p infrastructure/{firebase,terraform,docker}
                                                                                                                                                                                                                                                                                                                                                                                                                                         mkdir -p scripts tests/{unit,integration,e2e} docs

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 8: Generate initial files
                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 8: Generating initial files...${NC}"

                                                                                                                                                                                                                                                                                                                                                                                                                                         # Create package.json files
                                                                                                                                                                                                                                                                                                                                                                                                                                         cat > package.json << 'EOF'
                                                                                                                                                                                                                                                                                                                                                                                                                                         {
                                                                                                                                                                                                                                                                                                                                                                                                                                           "name": "designsync-ai",
                                                                                                                                                                                                                                                                                                                                                                                                                                             "version": "0.1.0",
                                                                                                                                                                                                                                                                                                                                                                                                                                               "private": true,
                                                                                                                                                                                                                                                                                                                                                                                                                                                 "workspaces": [
                                                                                                                                                                                                                                                                                                                                                                                                                                                     "apps/*",
                                                                                                                                                                                                                                                                                                                                                                                                                                                         "packages/*"
                                                                                                                                                                                                                                                                                                                                                                                                                                                           ],
                                                                                                                                                                                                                                                                                                                                                                                                                                                             "scripts": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "dev": "turbo run dev",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "build": "turbo run build",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "test": "turbo run test",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "lint": "turbo run lint",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "deploy:dev": "npm run build && firebase deploy --only hosting:dev",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "deploy:prod": "npm run build && firebase deploy --only hosting:prod"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "devDependencies": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "turbo": "latest",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 "prettier": "latest",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "eslint": "latest"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       # Create turbo.json
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cat > turbo.json << 'EOF'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "$schema": "https://turbo.build/schema.json",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "pipeline": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "build": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     "dependsOn": ["^build"],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           "outputs": ["dist/**", ".next/**"]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "dev": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         "cache": false,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               "persistent": true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       "test": {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "dependsOn": ["build"]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   # Create GitHub Actions workflow
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   mkdir -p .github/workflows
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   cat > .github/workflows/ci.yml << 'EOF'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   name: CI

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   on:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     push:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         branches: [main, dev]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           pull_request:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               branches: [main]

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               jobs:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 test:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     runs-on: ubuntu-latest
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         steps:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               - uses: actions/checkout@v3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     - uses: actions/setup-node@v3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             with:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       node-version: 18
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             - run: npm install -g pnpm
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   - run: pnpm install
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - run: pnpm test
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               - run: pnpm lint
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     - run: pnpm build
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     # Step 9: Create test files
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     echo -e "${YELLOW}Step 9: Setting up test suite...${NC}"

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     # Create unit test
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cat > tests/unit/sync-engine.test.ts << 'EOF'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     import { describe, it, expect } from 'vitest';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     import { SyncEngine } from '../../packages/sync-protocol/src';

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     describe('SyncEngine', () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       it('should initialize correctly', () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           const engine = new SyncEngine();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               expect(engine).toBeDefined();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   expect(engine.status).toBe('idle');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       it('should handle bidirectional sync', async () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           const engine = new SyncEngine();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               const result = await engine.sync({ source: 'figma', target: 'code' });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   expect(result.success).toBe(true);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       it('should resolve conflicts correctly', () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           const engine = new SyncEngine();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               const conflict = {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     local: { timestamp: 1000, value: 'a' },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           remote: { timestamp: 2000, value: 'b' }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   const resolved = engine.resolveConflict(conflict);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       expect(resolved.value).toBe('b'); // Last write wins
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 10: Initialize git flow
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 10: Setting up Git workflow...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         git add .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         git commit -m "feat: initial project setup with automated configuration"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         git push origin main

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 11: Deploy to Firebase
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 11: Deploying to Firebase...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         pnpm build
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         firebase deploy

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 12: Run initial tests
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 12: Running tests...${NC}"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         pnpm test

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         # Step 13: Create post-setup debug info
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         echo -e "${YELLOW}Step 13: Generating debug information...${NC}"

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         cat > debug-info.txt << EOF
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         DesignSync AI - Setup Debug Information
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Generated: $(date)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         System Information:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - Node Version: $(node -v)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - NPM Version: $(npm -v)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - OS: $(uname -s)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Environment Variables Set:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         $(grep -v SECRET .env | grep -v KEY | head -10)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Project Structure Created:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         $(find . -type d -maxdepth 3 | head -20)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Git Configuration:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - Remote: $(git remote -v | head -1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - Branch: $(git branch --show-current)

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Firebase Project:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         - Project ID: ${FIREBASE_PROJECT_ID:-Not Set}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Next St